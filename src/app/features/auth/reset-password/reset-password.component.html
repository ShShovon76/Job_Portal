<div class="auth-container">
    <div class="auth-card">
        <!-- Header -->
        <div class="auth-header text-center mb-5">
            <div class="logo mb-4">
                <i class="bi bi-key-fill text-primary fs-1"></i>
                <h2 class="mt-3 fw-bold">Set New Password</h2>
            </div>
            <p class="text-muted" *ngIf="!success">Create a new password for your account.</p>
        </div>

        <!-- Error Message -->
        <div *ngIf="errorMessage" class="alert alert-danger alert-dismissible fade show">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            {{ errorMessage }}
            <button type="button" class="btn-close" (click)="errorMessage = ''"></button>
        </div>

        <!-- Success Message -->
        <div *ngIf="success" class="alert alert-success text-center">
            <i class="bi bi-check-circle-fill fs-1 mb-3 d-block text-success"></i>
            <h4>Password Reset Successful!</h4>
            <p class="mb-4">Your password has been successfully reset.</p>
            <button (click)="navigateToLogin()" class="btn btn-primary">
                <i class="bi bi-box-arrow-in-right me-2"></i>Go to Login
            </button>
        </div>

        <!-- Reset Form -->
        <div *ngIf="!success">
            <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" novalidate>

                <!-- Password -->
                <div class="mb-4">
                    <label for="password" class="form-label fw-medium">New Password</label>
                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0">
                            <i class="bi bi-lock text-muted"></i>
                        </span>
                        <input type="password" id="password" formControlName="password" class="form-control"
                            [class.is-invalid]="f['password'].invalid && (f['password'].touched || f['password'].dirty)"
                            placeholder="Enter new password">
                    </div>

                    <div *ngIf="f['password'].invalid && (f['password'].touched || f['password'].dirty)"
                        class="invalid-feedback d-block">
                        <span *ngIf="f['password'].errors?.['required']">Password is required</span>
                        <span *ngIf="f['password'].errors?.['minlength']">Minimum 8 characters required</span>
                    </div>

                    <div class="form-text">
                        <small>Use 8 or more characters with a mix of letters, numbers & symbols</small>
                    </div>
                </div>

                <!-- Confirm Password -->
                <div class="mb-4">
                    <label for="confirmPassword" class="form-label fw-medium">Confirm New Password</label>

                    <div class="input-group">
                        <span class="input-group-text bg-light border-end-0">
                            <i class="bi bi-lock-fill text-muted"></i>
                        </span>
                        <input type="password" id="confirmPassword" formControlName="confirmPassword"
                            class="form-control" [class.is-invalid]="
                f['confirmPassword'].errors?.['passwordMismatch'] &&
                (f['confirmPassword'].touched || f['confirmPassword'].dirty)
              " placeholder="Confirm new password">
                    </div>

                    <div *ngIf="
            f['confirmPassword'].errors?.['passwordMismatch'] &&
            (f['confirmPassword'].touched || f['confirmPassword'].dirty)
          " class="invalid-feedback d-block">
                        Passwords do not match
                    </div>
                </div>

                <!-- Password Requirements -->
                <div class="password-requirements mb-4">
                    <h6 class="fw-medium mb-2">Password Requirements:</h6>
                    <ul class="list-unstyled small text-muted">

                        <li [class.text-success]="f['password'].value?.length >= 8">
                            <i class="bi" [class.bi-check-circle-fill]="f['password'].value?.length >= 8"
                                [class.bi-circle]="f['password'].value?.length < 8"></i>
                            Minimum 8 characters
                        </li>

                        <li [class.text-success]="hasUppercase()">
                            <i class="bi" [class.bi-check-circle-fill]="hasUppercase()"
                                [class.bi-circle]="!hasUppercase()"></i>
                            At least one uppercase letter
                        </li>

                        <li [class.text-success]="hasLowercase()">
                            <i class="bi" [class.bi-check-circle-fill]="hasLowercase()"
                                [class.bi-circle]="!hasLowercase()"></i>
                            At least one lowercase letter
                        </li>

                        <li [class.text-success]="hasNumber()">
                            <i class="bi" [class.bi-check-circle-fill]="hasNumber()"
                                [class.bi-circle]="!hasNumber()"></i>
                            At least one number
                        </li>

                    </ul>
                </div>
                <!-- Submit Button -->
                <button type="submit" class="btn btn-primary btn-lg w-100 mb-3"
                    [disabled]="loading || resetPasswordForm.invalid">
                    <span *ngIf="!loading">Reset Password</span>
                    <span *ngIf="loading">
                        <span class="spinner-border spinner-border-sm me-2"></span>
                        Resetting...
                    </span>
                </button>

            </form>
        </div>
    </div>
</div>
<auth-footer></auth-footer>